{% extends 'main.html' %}
{% load i18n %}
{% load static %}
{% load django_bootstrap5 %}
{% load custom_filters %}

{% block bootstrap5_extra_head %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'css/course.css' %}" />
<script type="text/javascript" src='{% static "js/course.js" %}'></script>
{% endblock %}

{% block content_area %}
<div class="d-flex flex-column h-100">
    <div class="col-8 col-sm-4 card mx-auto rounded-3 border border-primary mb-3 py-4 px-3">
        <h4 class="text-primary text-center fw-bold pb-3">
            {% translate "Niveau" %} {{ level.index }} :  {{ level.name }}
        </h4>

        {% course_progress_bar 0 %}
    </div>
    <div id="carouselExampleControls" class="carousel slide h-100" data-bs-intervale="false">
        <div class="carousel-inner px-5 h-100" role="listbox">
            <!-- <div class="carousel-item active h-100">
                <div class="col col-sm-6 card border border-primary mx-auto h-100">
                    <img src="{% static 'media/images/start_history_example.png'%}">
                </div>
            </div> -->
            {% for key, form in forms.items %}
            <div class="carousel-item {% if key == 1 %}active{% endif %} h-100">
                <div class="col card border border-primary p-sm-5 p-2 mx-auto h-100">
                    <form class="h-100" action="" method="post">
                        {% csrf_token %}
                        {% bootstrap_form form %}

                        <div class="row h-100">
                          <div class="col-md-6">
                            <h4>Answers</h4>
                            <div id="sortable" class="sortable">
                              <div
                                class="draggable-item d-flex w-100 border border-primary p-2"
                                data-answer="odd"
                              >
                                <div class="flex-grow-0">{{key}}.</div>
                                <div class="flex-grow-1">Answer 1</div>
                                <div class="flex-grow-0"><i class="bi bi-grip-vertical"></i></div> 
                              </div>
                              <div
                                class="draggable-item d-flex w-100 border border-primary p-2"
                                data-answer="even"
                              >
                                <div class="flex-grow-0">{{key}}.</div>
                                <div class="flex-grow-1">Answer 2</div>
                                <div class="flex-grow-0"><i class="bi bi-grip-vertical"></i></div> 
                              </div>
                              <div
                                class="draggable-item d-flex w-100 border border-primary p-2"
                                data-answer="odd"
                              >
                                <div class="flex-grow-0">{{key}}.</div>
                                <div class="flex-grow-1">Answer 3</div>
                                <div class="flex-grow-0"><i class="bi bi-grip-vertical"></i></div> 
                              </div>
                              <div
                                class="draggable-item d-flex w-100 border border-primary p-2"
                                data-answer="even"
                              >
                                <div class="flex-grow-0">{{key}}.</div>
                                <div class="flex-grow-1">Answer 4</div>
                                <div class="flex-grow-0"><i class="bi bi-grip-vertical"></i></div> 
                              </div>
                            </div>
                          </div>

                          <div class="col-md-6">
                            <div class="row h-100">
                              <div class="col-md-12 flex-fill">
                                <div id="odd" class="droppable border-primary bg-secondary h-100">
                                  <h4>Odd</h4>
                                </div>
                              </div>
                              <div class="col-md-12 flex-fill">
                                <div id="even" class="droppable border border-secondary bg-secondary h-100">
                                  <h4>Even</h4>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <button type="submit" class="btn btn-primary mt-3">Submit</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
        <button class="carousel-control-prev w-auto" type="button" data-bs-target="#carouselExampleControls"
            data-bs-slide="prev">
            <span class="carousel-control-prev-icon text-primary" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next w-auto" type="button" data-bs-target="#carouselExampleControls"
            data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>

<script type="text/javascript" src="{% static 'npm_components/jquery/dist/jquery.min.js' %}"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script>
    $(function () {
        $(".draggable-item").draggable({
            revert: "invalid",
        });

        $(".droppable").droppable({
            accept: ".draggable-item",
            drop: function (event, ui) {
                $(this).append($(ui.helper).clone());
                $(ui.helper).remove();
            }
        });
    });
</script>

{% endblock %}
